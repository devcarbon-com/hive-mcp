;; Shadow-cljs build configuration for Olympus Web UI
;; ClojureScript dashboard for hive-mcp swarm monitoring
;; All JS deps from npm (react, react-dom, @xyflow/react, dagre, @xterm/*)
{:source-paths ["src"]

 :dependencies [[reagent "2.0.1"]
                [re-frame "1.3.0"]
                [day8.re-frame/http-fx "0.2.4"]
                [cljs-ajax "0.8.4"]
                [com.cognitect/transit-cljs "0.8.280"]
                [binaryage/devtools "1.0.7"]]

 :dev-http {3000 "resources/public"}

 :builds
 {:app {:target :browser
        :output-dir "resources/public/js"
        :asset-path "/js"

        ;; xterm.js uses modern JS (let before declaration) that breaks
        ;; Closure's default ES5 processing. ES2020 output avoids rewriting.
        :compiler-options {:output-feature-set :es2020}

        :modules {:main {:init-fn olympus-web.core/init!}}

        :devtools {:http-root "resources/public"
                   :http-port 3000
                   :watch-dir "resources/public"
                   :preloads [devtools.preload]}}

  :release {:target :browser
            :output-dir "resources/public/js"
            :asset-path "/js"
            :modules {:main {:init-fn olympus-web.core/init!}}
            :compiler-options {:optimizations :advanced
                               :pretty-print false}}}}
